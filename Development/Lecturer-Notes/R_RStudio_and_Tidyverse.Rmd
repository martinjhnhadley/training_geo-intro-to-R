---
title: "R, RStudio and Tidyverse Stack"
output: slidy_presentation
runtime: shiny
css: "www/teachingnotes.css"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# The R Language

R is a scripting language and a very powerful tool for data analysis and presentation, primarily due to the huge user base and their dedication to developing free and open source libraries/packages covering a vast range of different knowledge domains:

- Regression
- Machine Learning
- Image Analysis
- Network Analysis

<p>

The Comprehensive R Archive Network [(CRAN)](cran.r-project.org) is the canonical repository for R packages, note that almost all* packages hosted on CRAN may be used within a Shiny app.

*\*Packages dependent on parallel or distributed computing are unlikely to be supported, contact shinyapps-support@rstudio.com with any questions*

# Learning R

Oxford provides a variety of courses on R in the [ITLP Catalog](http://courses.it.ox.ac.uk), if there are additional courses you would like to see run please do ask!

Oxford also provides access to [lynda.com](http://lynda.com) for all staff and students at the University, Lynda provides training material on a whole host of programming languages and analytical techniques.

[Datacamp.com](datacamp.com) is a tool for learning the R language and analytical techniques directly in the browser - note that a subscription is required to access some content.

# The R Console

R is the name of the programming language and *console* within which many users of R write and evaluate their code.

To use R on your local machine you must [download](https://cran.r-project.org/bin/windows/base/) and install the R Console, it's available on Windows, OS X and Linux.

Like all consoles, this application provides [only] the following functionality:

<div class="row">
  <div class="col-md-6">
- Write code and script files
- Evaluate code and script files
  </div>
  <div class="col-md-6">
<img src="images/RConsole.png" width = "100%"/>
  </div>
</div>

# <img src="images/RStudioLogo.png" height="100px" alt = RStudio/>

RStudio is a free, open-source IDE (integrated development environment) that provides an extremely powerful and friendly interface for developing with R.

IDEs make it easier to manage your programming, providing the following features:

- Interactive overview of your variables and datasets
- Interactive file explorer for managing file dependencies
- Tabbed script interface, allowing code to be split into smaller, more manageable files
- Integrated documentation for the primary language of the IDE

# <img src="images/RStudioLogo.png" height="100px" alt = RStudio/>

RStudio, however, provides much more exciting features on top of a standard IDE:

- Integrated visualisation previews, including interactive htmlwidgets
- Support for creating, previewing and deploying interactive Shiny apps
- A powerful literate programming interface through RMarkdown*
- Tools for developing R packages

*more on RMarkdown after some actual code.

<img src="images/RStudioScreenshot.png" width = "100%" alt = RStudio/>

# Base R and R Packages

When R is installed on your computer the machinery necessary to run R code is added to your computer and a number of "base" packages including; `stats`, `utils` and `graphics`. 

See <a href="http://stackoverflow.com/a/9705725/1659890">stackoverflow.com/a/9705725/1659890</a> for further details.

These packages will not get you far in life, unless you're prepared to write a **lot** of code from scratch. 

But you can guarantee* that any code samples you see online referring to "base R" only will work without having to install additional libraries.

# Installing Packages

If a package is on CRAN then it is "installed" onto your using the following code, you're advised to write this console directly into the console and *not* into your documents

<div class="incremental"> 
- You (probably) don't want to reinstall a library everytime your script is evaluated

```{r, eval=FALSE}
install.packages("ggplot2")
```

Once a library is installed, functions can be accessed using `ggplot::geom_point()`.

However, libraries are designed to be used after being loaded:

```{r, eval=FALSE}
library(ggplot2)
```
</div>

# Warning on Packages

While packages are incredibly useful, it is important not to offload all thought/development to packages for three important reasons:

- The package might be written poorly (unoptimised, or with incorrect assumptions)
- The package may well become unsupported in the future if the developer does not maintain it
- Not all packages are designed to play nicely with one another, manipulating your code to play nice with `obnoxiousR` might be harder than simple writing in base R

# RStudio-backed Packages

<div class="row">
  <div class="col-md-5" style="vertical-align:middle;">
<img src="images/tidyverse.png" height="400px" alt = RStudio/>
  </div>
  <div class="col-md-7">
- The "tidyverse" is a collection of packages maintained by RStudio devs [particularly Hadley Wickham]
- tidyverse packages play extremely nicely together
- tidyverse packages are extremely useful for preparing data for interactive visualisations
- tidyverse packages are highly optimised, often specifically around nitpicky details of bse R (readr is a good example of this)
- tidyverse is the backbone of the recently published, free online book [R for Data Science](http://r4ds.had.co.nz)
  </div>
</div>

# Tidyverse package workflow

<div class="row">
  <div class="col-md-5" style="vertical-align:middle;">
<img src="images/tidyverse.png" height="400px" alt = RStudio/>
  </div>
  <div class="col-md-7">
- Import with `readr`
- Reshape with `tidyr`
- Filter, modify and query with `dplyr`
- Visualise with `ggplot` (but that's not interactive...)
  </div>
</div>

<p>
RStudio has links to a fantastic cheatsheet on the tidyverse (the complicated reshaping/filtering part of it) available under Help > Cheatsheets

# R Syntax Catch-up

We're going to be using what to some users is considered advanced R programming during today's session, but often experienced R users get tripped up over brackets. It's good to cement into your head what each bracket is for so that when you read code you know what's going on:

- Round brackets () 

<div class="incremental"> 
Encapsulate the arguments for a function, in the case of `rep("Hello World", 2)` the round brackets encapsulate the two arguments passed to the function `rep` - arguments are therefore deliminated by commas.
</div>

- Square brackets [] 

<div class="incremental"> 
Used for extracting parts (rows, columns, individual elements) from data structures - that's there only use
</div>

- Braces {} 

<div class="incremental"> 
Used for containing expressions - when writing mathematical expressions by hand round brackets are usually used for controlling precedence (order of operations), but in R you should write 2*{x+1}^2.


Braces are necessary where *more than one thing* is being done in an individual argument

```{r}
rep(
  "strings",
  {
    no1 <- 2
    no1 +3
  }
)
```
</div>

# A note on reproducability

Reproducibility is a hot topic in research today, though the buzzwords Open Access and Open Data are usually used in its place.

Unfortunately, a common feature of research groups is PhDWare [DPhilWare] or write-only code.

Routines for data preparation, analysis and visualisation are often undocumented and in a tangled mess that can't be well understood by anyone other than the original researcher.

# RStudio Projects

Projects provide a useful mechanic for clearly distinguishing between different work packages/projects. Working with projects provides the following advantages:

>- Working directories are set as the project directory
>- The project directory can easily be explored through a GUI
>- Previously assigned variables are reloaded when a project is reopened
>- Easily switch between Projects from the Project menu.

# Creating RStudio Projects

From this point on, whenever we start a new exercise/worked example we're going to create a new project to get you into this routine.

The steps are as follows:

1 File -> New Project OR the Projects menu in the top-right of the screen

<center><img src="images/projects-menu-200.png" width = "500px" alt = RMarkdown-Documents/></center>

3 Choose "New Directory" and "Empty Project" 

4 Browse to where your R projects will live

5 Give your project a sensible name, like "First-Project"

